<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; Complexity – Adaptation Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./commons.html" rel="next">
<link href="./decision.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-27c261d06b905028a18691de25d09dde.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./complex.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Complexity</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Adaptation Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./evolution.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Evolutionary Foundations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./populations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Population Ecology</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./culture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Does Culture Evolve?</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./decision.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Risk, Uncertainty, and Decision-Making</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./complex.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Complexity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./commons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Emergence and Governing the Commons</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Dynamic Optimization and Adaptive Management</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./efficiency.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Efficiency Is the Enemy</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./robust.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">The Structure of Successful Problem-Solving</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sec-lv" id="toc-sec-lv" class="nav-link active" data-scroll-target="#sec-lv"><span class="header-section-number">6.0.1</span> Lotka-Volterra</a></li>
  <li><a href="#feedback" id="toc-feedback" class="nav-link" data-scroll-target="#feedback"><span class="header-section-number">6.1</span> Feedback</a></li>
  <li><a href="#complex-systems" id="toc-complex-systems" class="nav-link" data-scroll-target="#complex-systems"><span class="header-section-number">6.2</span> Complex Systems</a>
  <ul class="collapse">
  <li><a href="#sensitivity-to-initial-conditions" id="toc-sensitivity-to-initial-conditions" class="nav-link" data-scroll-target="#sensitivity-to-initial-conditions"><span class="header-section-number">6.2.1</span> Sensitivity to Initial Conditions</a></li>
  <li><a href="#equilibria-and-attractors" id="toc-equilibria-and-attractors" class="nav-link" data-scroll-target="#equilibria-and-attractors"><span class="header-section-number">6.2.2</span> Equilibria and Attractors</a></li>
  <li><a href="#catastrophes" id="toc-catastrophes" class="nav-link" data-scroll-target="#catastrophes"><span class="header-section-number">6.2.3</span> Catastrophes</a></li>
  </ul></li>
  <li><a href="#hysteresis" id="toc-hysteresis" class="nav-link" data-scroll-target="#hysteresis"><span class="header-section-number">6.3</span> Hysteresis</a>
  <ul class="collapse">
  <li><a href="#critical-slowing-down" id="toc-critical-slowing-down" class="nav-link" data-scroll-target="#critical-slowing-down"><span class="header-section-number">6.3.1</span> Critical Slowing Down</a></li>
  </ul></li>
  <li><a href="#stability-analysis-of-the-lotka-volterra-model" id="toc-stability-analysis-of-the-lotka-volterra-model" class="nav-link" data-scroll-target="#stability-analysis-of-the-lotka-volterra-model"><span class="header-section-number">6.4</span> Stability Analysis of the Lotka-Volterra Model</a></li>
  <li><a href="#stability-and-complexity" id="toc-stability-and-complexity" class="nav-link" data-scroll-target="#stability-and-complexity"><span class="header-section-number">6.5</span> Stability and Complexity</a></li>
  <li><a href="#stability-vulnerability-resilience" id="toc-stability-vulnerability-resilience" class="nav-link" data-scroll-target="#stability-vulnerability-resilience"><span class="header-section-number">6.6</span> Stability, Vulnerability, Resilience</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-complexity" class="quarto-section-identifier"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Complexity</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The Italian biologist Humberto D’Ancona noted that during the first World War, the composition of fish in the markets around the Adriatic Sea changed substantially. During the war, the percentage of predatory fish for sale in the markets of Trieste, Fiume, and Venice increased. D’Ancona had no explanation for this and approached his father-in-law, the eminent mathematician Vito Volterra, with the riddle. Volterra’s solution forms the foundation for nearly all subsequent theory regarding the interaction of species within communities. The great American biologist and demographer, Alfred Lotka, developed the same framework about the same time and the equations have since been known as the Lotka-Volterra model for predatory/prey dynamics.</p>
<p>The classical theory of species interactions is attributable to Alfred Lotka and Vito Volterra Reduce communities to a single consumer-resource relationship – typically between a primary consumer (i.e., a herbivore) and a secondary consumer (i.e., a carnivore)</p>
<p>Assumptions of Lotka-Volterra Model: 1. in the absence of a predator, the prey population increases exponentially 2. in the absence of prey, the predator population decays exponentially 3. per capita rate of kill a linear function of prey density 4. each kill contributes equally to predator growth</p>
<p>We can write the equations for the predator-prey model that encapsulates these assumptions.</p>
<p><span class="math display">\[
\begin{align}
\dot{x}_1 &amp;=  x_1 (r_1 - a_{12} x_2) \\
\dot{x}_2 &amp;=  x_2 (-r_2 + a_{21} x_1)
\end{align}
\]</span> Here, we have used the notation that <span class="math inline">\(\dot{x} \equiv dx/dt\)</span>. That is the dotted variable represents a time derivative. The prey population is <span class="math inline">\(x_1\)</span> and its growth rate is <span class="math inline">\(r_1\)</span>. Similarly, the predator population is <span class="math inline">\(x_2\)</span> and its growth rate is <span class="math inline">\(r_2\)</span>. The parameters <span class="math inline">\(a_{ij}\)</span> are interaction terms, where <span class="math inline">\(a_{12}\)</span> is the impact that predators have on the growth rate of the prey population and <span class="math inline">\(a_{21}\)</span> is the rate a which prey are converted into more predators. Note that in the absence of predator/prey, the solutions to the two equations are exponential increase/decay as per assumptions 1 and 2 above.</p>
<p>We can use the <code>R</code> package <code>deSolve</code> to numerically integrate these equations, plot the solutions, etc.</p>
<section id="sec-lv" class="level3" data-number="6.0.1">
<h3 data-number="6.0.1" class="anchored" data-anchor-id="sec-lv"><span class="header-section-number">6.0.1</span> Lotka-Volterra</h3>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(deSolve)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Lotka-Volterra equations</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>lv <span class="ot">&lt;-</span> <span class="cf">function</span>(t, x, parms) {</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(parms), {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    dx1 <span class="ot">&lt;-</span> r1<span class="sc">*</span>x[<span class="dv">1</span>] <span class="sc">-</span> c1<span class="sc">*</span>x[<span class="dv">1</span>]<span class="sc">*</span>x[<span class="dv">2</span>]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    dx2 <span class="ot">&lt;-</span> <span class="sc">-</span>r2<span class="sc">*</span>x[<span class="dv">2</span>] <span class="sc">+</span> c2<span class="sc">*</span>x[<span class="dv">1</span>]<span class="sc">*</span>x[<span class="dv">2</span>]</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">c</span>(dx1,dx2)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(results)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="co"># parameters</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>xstart <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">x1=</span><span class="dv">10</span>,<span class="at">x2=</span><span class="dv">1</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="at">length=</span><span class="dv">1001</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">r1=</span><span class="fl">0.5</span>,<span class="at">r2=</span><span class="fl">0.5</span>, <span class="at">c1=</span><span class="fl">0.1</span>,<span class="at">c2=</span><span class="fl">0.02</span>)</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ode</span>(xstart,times,lv,parms))</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(out1, <span class="fu">plot</span>(time, x1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>, </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="st">"Population Size"</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">100</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>)))</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(out1, <span class="fu">lines</span>(time, x2, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"blue"</span>))</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>,<span class="fu">c</span>(<span class="st">"prey"</span>,<span class="st">"predator"</span>), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Time series of the two-species Lotka-Volterra system.</p>
<p>And the phase portrait, which takes out the middle man, as it were (i.e., time).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Phase Portrait</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(out1, <span class="fu">plot</span>(x1, x2, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">col=</span><span class="st">"magenta"</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlab=</span><span class="st">"Prey Population Size"</span>, </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">ylab=</span><span class="st">"Predator Population Size"</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">90</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It just keeps cycling…</p>
<p>The canonical model of lynxes and hares, the Lotka-Volterra predator-prey model shows clock-like regularity. Usually presented as an endlessly-cycling time series, but I think it’s more useful to show the phase portrait, where the abundances of the predator are plotted directly against the abundances of the prey, rather than both of the against time.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>lh <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"data/LynxHare.txt"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lh) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Year"</span>,<span class="st">"Hare"</span>,<span class="st">"Lynx"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(lh<span class="sc">$</span>Year, lh<span class="sc">$</span>Hare, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col=</span><span class="st">"red"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Abundance"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(lh<span class="sc">$</span>Year, lh<span class="sc">$</span>Lynx, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topright"</span>, <span class="fu">c</span>(<span class="st">"Hares"</span>,<span class="st">"Lynx"</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"blue"</span>), <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Reality is always messier than theory.</p>
<p><span class="citation" data-cites="hastings_powell1991">Hastings and Powell (<a href="references.html#ref-hastings_powell1991" role="doc-biblioref">1991</a>)</span> took the standard Lotka-Volterra model and added a third species. They used biologically realistic parameter values for a three-level food web. Chaos ensued (literally).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>hp91 <span class="ot">&lt;-</span> <span class="cf">function</span>(t,x,parms){</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(<span class="fu">as.list</span>(<span class="fu">c</span>(parms,x)), {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    dx1 <span class="ot">&lt;-</span> x1<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x1) <span class="sc">-</span> x2<span class="sc">*</span>a1<span class="sc">*</span>x1<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>b1<span class="sc">*</span>x1)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    dx2 <span class="ot">&lt;-</span> x2<span class="sc">*</span>a1<span class="sc">*</span>x1<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>b1<span class="sc">*</span>x1) <span class="sc">-</span> x3<span class="sc">*</span>a2<span class="sc">*</span>x2<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>b2<span class="sc">*</span>x2) <span class="sc">-</span> d1<span class="sc">*</span>x2</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    dx3 <span class="ot">&lt;-</span> x3<span class="sc">*</span>a2<span class="sc">*</span>x2<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>b2<span class="sc">*</span>x2) <span class="sc">-</span> d2<span class="sc">*</span>x3</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    res <span class="ot">&lt;-</span> <span class="fu">c</span>(dx1,dx2,dx3)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">list</span>(res)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  })</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co">#b1 varied from 2.0-6.2</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>parms <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">a1=</span><span class="fl">5.0</span>, <span class="at">b1=</span><span class="fl">3.0</span>, <span class="at">a2=</span><span class="fl">0.1</span>, <span class="at">b2=</span><span class="fl">2.0</span>, <span class="at">d1=</span><span class="fl">0.4</span>, <span class="at">d2=</span><span class="fl">0.01</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>xstart <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">x1=</span><span class="fl">0.9692178</span>, <span class="at">x2=</span><span class="fl">0.02620731</span>, <span class="at">x3=</span><span class="fl">7.865967</span>) <span class="co">#their starting values</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>times <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">1000</span>, <span class="at">length=</span><span class="dv">10001</span>)</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>out1 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">lsoda</span>(xstart, times, hp91, parms))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out1[,<span class="dv">1</span>]<span class="sc">/</span><span class="dv">20</span>,out1[,<span class="dv">4</span>], <span class="at">log=</span><span class="st">"y"</span>,<span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="dv">3</span>,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Time"</span>,<span class="at">ylab=</span><span class="st">"Population Size"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.01</span>,<span class="fl">10.5</span>))</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(out1[,<span class="dv">1</span>]<span class="sc">/</span><span class="dv">20</span>,out1[,<span class="dv">3</span>],<span class="at">col=</span><span class="st">"red"</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(out1[,<span class="dv">1</span>]<span class="sc">/</span><span class="dv">20</span>,out1[,<span class="dv">2</span>],<span class="at">col=</span><span class="st">"magenta"</span>, <span class="at">lwd=</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>And the phase portraits</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out1[,<span class="dv">2</span>],out1[,<span class="dv">3</span>], <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>, <span class="at">xlab=</span><span class="st">"species 1"</span>, <span class="at">ylab=</span><span class="st">"species 2"</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out1[,<span class="dv">2</span>],out1[,<span class="dv">4</span>], <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>, <span class="at">xlab=</span><span class="st">"species 1"</span>, <span class="at">ylab=</span><span class="st">"species 3"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(out1[,<span class="dv">3</span>],out1[,<span class="dv">4</span>], <span class="at">type=</span><span class="st">"l"</span>,<span class="at">col=</span><span class="st">"blue"</span>, <span class="at">xlab=</span><span class="st">"species 2"</span>, <span class="at">ylab=</span><span class="st">"species 3"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is a canonical example of complexity.</p>
</section>
<section id="feedback" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="feedback"><span class="header-section-number">6.1</span> Feedback</h2>
<p>Feedback is when the output of a system becomes the input for future iteration. Feedback systems can greatly complicated the analysis (and meaning) of cause and effect. Feedback is the foundation of complex systems. Feedback is necessarily nonlinear.</p>
<p>There are two broad categories of feedback. <strong>Negative Feedback</strong> is self-regulatory. Examples include thermostats, insulin-glucagon regulation of blood glucose, logistic growth. <strong>Positive Feedback</strong> is runaway. Examples include: nuclear fission, economic cycles, lactation, human capital. When you have positive feedback, small disturbances will grow. Another way to describe positive feedback is to say that it is in phase with inputs.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/feedback_loop.png" class="img-fluid figure-img"></p>
<figcaption>A feedback loop.</figcaption>
</figure>
</div>
<p>More…</p>
</section>
<section id="complex-systems" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="complex-systems"><span class="header-section-number">6.2</span> Complex Systems</h2>
<p>Collection of interacting units bound together through feedback (coupling) Complex systems lie at the boundary between perfect order and perfect disorder A Complex Adaptive System (CAS) is a subset of a complex system in which there is the capacity for learning and adaptation</p>
<p>Complex systems generally have many connections between elements (i.e., coupling) Many complex systems are characterized by nonlinear change (e.g., competition, predation, mobility, economic production, epidemic models) These can make prediction and management difficult Just because things vary, doesn’t mean anything is wrong This is what we expect of complex systems – not simple equilibria</p>
<p>A nice illustration of the sensitivity to initial conditions comes from <span class="citation" data-cites="may1976">May (<a href="references.html#ref-may1976" role="doc-biblioref">1976</a>)</span>. logistic map is a discrete-time model for population dynamics. It’s a simple equation that can lead to some very complex dynamics.</p>
<section id="sensitivity-to-initial-conditions" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="sensitivity-to-initial-conditions"><span class="header-section-number">6.2.1</span> Sensitivity to Initial Conditions</h3>
<p>Consider the plot below inspired by the work of <span class="citation" data-cites="may1973">May (<a href="references.html#ref-may1973" role="doc-biblioref">1973</a>)</span>. Plot time series for a logistic map where the growth rate is in the chaotic region (<span class="math inline">\(a=3.8284\)</span>). The logistic map is a nonlinear difference equation. It is a discrete-time popualtion model that takes the form,</p>
<p><span class="math display">\[ x_{t+1} = a x_t (1-x_t). \]</span> We start the two populations from barely different initial conditions <span class="math inline">\(x_0=0.2\)</span> vs.&nbsp;<span class="math inline">\(x_0=0.20001\)</span>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## logistic map</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">expression</span>(a<span class="sc">*</span>x<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="do">## every integer period cycle</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">3.8284</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> (<span class="fl">0.2</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xx</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>){</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">eval</span>(f)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  xx <span class="ot">&lt;-</span> <span class="fu">c</span>(xx,x)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="do">## just barely different initial conditions</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>xx1 <span class="ot">&lt;-</span> (<span class="fl">0.20001</span>)</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> xx1</span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(t <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>){</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">eval</span>(f)</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  xx1 <span class="ot">&lt;-</span> <span class="fu">c</span>(xx1,x)</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">200</span>,xx,<span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="st">"X"</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>), <span class="at">col=</span><span class="st">"blue"</span>)</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">200</span>,xx1, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pretty wild. Two populations that differ initially by just <span class="math inline">\(1 \times 10^{-5}\)</span> take totally different trajectories when the same population model is applied to them. This is the essence of sensitivity to initial conditions.</p>
</section>
<section id="equilibria-and-attractors" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="equilibria-and-attractors"><span class="header-section-number">6.2.2</span> Equilibria and Attractors</h3>
<p>Supply is upward-sloping. When the price increases, producers have more incentive to increase supply. Similarly, as the price is high, there isn’t much demand from consumers, so it is downward-sloping.</p>
<p>The classic equilibrium is a single point as seen in the ubiquitous model for a competitive equilibrium price in economics.</p>
<p>Is it just me or are the axes on this classic models reversed from what we would expect in science? The quantity (either supplied or demanded) is responding to price, which suggests that Quantity is the dependent variable and should be on the y-axis.</p>
<p>The ESSs for the frequency-dependent models discussed in <a href="culture.html" class="quarto-xref"><span>Chapter 4</span></a> have this form too.</p>
<p>An attractor is a generalization of the idea of an equilibrium In essence, an attractor is just a set of points to which a dynamical system tends to evolve from a wide range of initial conditions A basin of attraction is a region in the phase space where once the system is in that region, it will end up on the attractor</p>
<p>Hysteresis.</p>
<p>Hysteresis is simply the dependence of the state of a system on its history It’s one important form a path-dependence Appreciation of the dollar and factory closures Scheffer and Carpenter (2003) use a slightly different meaning: Multiple states persisting under the same environmental conditions Basically, synonymous with alternative stable states</p>
<p><span class="citation" data-cites="demenocal_etal2000">deMenocal et al. (<a href="references.html#ref-demenocal_etal2000" role="doc-biblioref">2000</a>)</span> provide an example of a sudden shift in a stable state.</p>
<p>A system has alternative attractors if there can be more than one stable state for the same values of external conditions <span class="citation" data-cites="scheffer_carpenter2003">(<a href="references.html#ref-scheffer_carpenter2003" role="doc-biblioref">Scheffer and Carpenter 2003</a>)</span></p>
<p>Forcing. Slow dynamics.</p>
</section>
<section id="catastrophes" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="catastrophes"><span class="header-section-number">6.2.3</span> Catastrophes</h3>
<p>An example from <span class="citation" data-cites="noy-meir1975">Noy-Meir (<a href="references.html#ref-noy-meir1975" role="doc-biblioref">1975</a>)</span></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Noy-Meir (1975) model</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>logistic.recruit <span class="ot">&lt;-</span> <span class="fu">expression</span>(r<span class="sc">*</span>N<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> (N<span class="sc">/</span>K)<span class="sc">^</span>theta))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>no <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fl">0.45</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,K,<span class="at">length=</span><span class="dv">500</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(N,<span class="fu">eval</span>(logistic.recruit), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Relative Producer Density"</span>, </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Relative Productivity"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>))</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is known as a “production function” or “recruitment function.” It tells you how big a change in a population will be next year based on its size this year (e.g., how many “recruits”). They are typically humped, where the number of recruits is very small at either very low population densities or near carrying capacity. Sometimes, they’re not humped when density-dependence is weak or absent, but usually they are humped, often asymmetrically.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Holling Type II</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>h2 <span class="ot">&lt;-</span> <span class="fu">expression</span>(a<span class="sc">*</span>N<span class="sc">/</span>(b <span class="sc">+</span> a<span class="sc">*</span>x))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> N<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fl">0.7</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="dv">6</span><span class="sc">*</span><span class="fu">eval</span>(h2), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Relative Producer Density"</span>, </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Consumer Attack Rate"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>))</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This is the Holling Type II Functional Response (yes, that Holling). It is a saturating function. For a fixed number of predators, the number of prey they take (their “attack rate”) will increase with the prey density, but it will saturate. You can only eat so much.</p>
<p>Now, suppose there is population growth of the predators/consumers. What’s going to happen to this curve? Well, it will shift upward because there are more consumers so the rate at which they remove prey will be higher.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="dv">6</span><span class="sc">*</span><span class="fu">eval</span>(h2), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Relative Producer Density"</span>, </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Consumer Attack Rate"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="dv">12</span><span class="sc">*</span><span class="fu">eval</span>(h2), <span class="at">lwd=</span><span class="dv">3</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>More consumers harvesting at the same rate means that the overall attack rate increases.</p>
<p>We can now put this all together.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(N,<span class="fu">eval</span>(logistic.recruit), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">xlab=</span><span class="st">"Relative Producer Density"</span>, <span class="at">ylab=</span><span class="st">"Relative Productivity"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">15</span>))</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">6</span><span class="sc">*</span><span class="fu">eval</span>(h2), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#lines(x, 8*eval(h2))</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#lines(x, 10*eval(h2))</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, <span class="dv">12</span><span class="sc">*</span><span class="fu">eval</span>(h2), <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">#lines(x, 13*eval(h2))</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#lines(x, 14*eval(h2))</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fu">c</span>(<span class="fl">8.702413</span>, <span class="fl">36.521362</span>, <span class="fl">57.497146</span>, <span class="fl">85.464859</span>), <span class="fu">c</span>(<span class="fl">3.485678</span>, <span class="fl">10.441517</span>, <span class="fl">11.003335</span>,  <span class="fl">5.652690</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="st">"red"</span>,<span class="st">"red"</span>,<span class="st">"green"</span>,<span class="st">"green"</span>), <span class="at">cex=</span><span class="dv">2</span>, <span class="at">pch=</span><span class="dv">16</span>)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">36.521362-7.5</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="fl">36.521362</span><span class="dv">-1</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">code=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">36.521362</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="fl">36.521362+7.5</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">57.497146-7.5</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="fl">57.497146</span><span class="dv">-1</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="fl">57.497146</span><span class="sc">+</span><span class="dv">1</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="fl">57.497146+7.5</span>, <span class="fl">10.441517</span><span class="sc">+</span><span class="dv">2</span>, <span class="at">code=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(<span class="fl">59.13355</span>, <span class="fl">86.65497</span>), <span class="fu">c</span>(<span class="fl">11.458140</span>,  <span class="fl">6.107494</span>), <span class="fu">c</span>(<span class="st">"F2"</span>, <span class="st">"F1"</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The growth of the consumers is typically very slow relative to the recruitment of the producer population. It’s not hard to imagine a series of functional-response curves sweeping upward gradually as the population of consumers increases.</p>
<p>In this figure, the humped recruitment curve is intersected by a nonlinear extraction curve. Harvesting effort increases as the resource population increases, but it does so in a decelerating manner. In this particular curve, extraction also accelerates for the lowest levels of the resource population. The shapes of these curves (which are pretty standard models for resource-extraction known as “functional response” curves) mean that they hit the recruitment function in three places each. Equilibria occur at three points: near zero, middle producer density, and high producer density. The green points (high consumer density) are stable equilibria – the movement of perturbations on this side of the curve is indicated by the grey arrows at the top. The red points are unstable (note the grey arrows). Depending on the size and direction of a perturbation from this point in the system, the productivity can easily be knocked down to the catastrophic equilibrium of extremely low productivity. Note that the fold catastrophe also has three equilibria for any set of conditions (except the special cases of the folds).</p>
<p>Note that each harvest curve produces 3 equilibria: the green ones are stable, the red ones are unstable, and the unmarked ones near zero turn out also to be stable (just not marked because the dots would get crowded down there).</p>
<p>This is what we could call “forcing.” It’s a slow change—in a specific direction—that gradually changes the state of the system overall. Slow forcing ultimately produces catastrophes.</p>
<p>If we perform the forcing of a functional-response curve on that hump-shaped recruitment curve, collect the three stable points for each changing functional-response curve, and plot those, we get something that looks like this. The stable points are the solid lines of the attractor. The unstable points are the dotted line. This model was developed by <span class="citation" data-cites="noy-meir1975">Noy-Meir (<a href="references.html#ref-noy-meir1975" role="doc-biblioref">1975</a>)</span>.</p>
<p>If we trace a series of curves moving from low to high exploitation like the two intersecting functional responses in this figure, what we end up with is an attractor that looks very much like the fold-catastrophe. This doesn’t actually seem that exotic after all.</p>
<p>In high-sensitivity environments like a semi-desert or the Arctic, the extent of human exploitation is very likely near the maximum sustainable level. If environmental productivity were to decline as a function of climate change, while the extent of exploitation remains constant, the system can be pushed into catastrophic regime-shift.</p>
<p>The the system state approaches the fold, the derivative of the attractor goes infinite. This means that perturbations on or very near the fold can lead the system to change wildly, potentially entering a new (and worse) basin of attraction – in this case, the lower branch of the attractor.</p>
<p>It resurfaced in the work of Carpenter, Scheffer, and their collaborators. <span class="citation" data-cites="scheffer_etal2009">Scheffer et al. (<a href="references.html#ref-scheffer_etal2009" role="doc-biblioref">2009</a>)</span> use the fold-catastrophe model extensively in their work on predicting catastrophes.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fold Catastrophe</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">12</span>,<span class="dv">12</span>,<span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">12</span>,<span class="dv">10</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">3</span>), <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span><span class="dv">100</span><span class="sc">*</span>x,x,<span class="at">type=</span><span class="st">"l"</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>, <span class="at">xlab=</span><span class="st">"Conditions"</span>, <span class="at">ylab=</span><span class="st">"System State"</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">3</span><span class="sc">+</span><span class="dv">100</span><span class="sc">*</span>y,y, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(y<span class="sc">^</span><span class="dv">3-100</span><span class="sc">*</span>y,<span class="sc">-</span>y, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># unstable</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">200</span>,<span class="sc">-</span><span class="fl">2.75</span>, <span class="at">code=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="sc">-</span><span class="fl">1.5</span>,<span class="sc">-</span><span class="dv">200</span>, <span class="fl">0.75</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lower stable</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="sc">-</span><span class="dv">6</span>,<span class="sc">-</span><span class="dv">200</span>, <span class="sc">-</span><span class="fl">8.25</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="sc">-</span><span class="fl">11.5</span>,<span class="sc">-</span><span class="dv">200</span>, <span class="sc">-</span><span class="fl">9.25</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co">#upper stable</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="fl">13.5</span>,<span class="sc">-</span><span class="dv">200</span>, <span class="fl">11.25</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="fl">8.25</span>,<span class="sc">-</span><span class="dv">200</span>, <span class="fl">10.5</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">357</span>,<span class="dv">7</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">bg=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">376.6749</span>, <span class="fl">7.87279</span>, <span class="st">"F1"</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">391.1386</span>, <span class="sc">-</span><span class="dv">11</span>, <span class="st">"F2"</span>)     </span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">357</span>,<span class="sc">-</span><span class="fl">11.452987</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">bg=</span><span class="st">"white"</span>)</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">357</span>,<span class="fl">6.5</span>,<span class="dv">357</span>,<span class="fl">4.9</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="fu">arrows</span>(<span class="dv">357</span>,<span class="dv">4</span>,<span class="dv">357</span>,<span class="sc">-</span><span class="fl">10.8</span>, <span class="at">code=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">length=</span><span class="fl">0.1</span>, <span class="at">col=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="fl">358.1289</span>,<span class="fl">4.37</span>, <span class="at">pch=</span><span class="dv">21</span>, <span class="at">cex=</span><span class="dv">2</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">bg=</span><span class="fu">grey</span>(<span class="fl">0.75</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Solid lines indicate stable attractor. Perturbations tend to return. Dashed lines indicate unstable attractor: perturbations tend to move away from attractor. There are thus two basins of attraction.</p>
<p>When you approach the fold (point F1), a small perturbation can push you from the stable to unstable branch quite easily. Then, if there is another perturbation below the attractor, the system state can move rapidly down to the bad stable branch (F2).</p>
<p>A catastrophe is a sudden shift given a small perturbation.</p>
<p>The solid parts of the curve are stable—when the system state is perturbed when in the vicinity of this part of the attractor, it tends to return, as indicated by the grey arrows pointing back to the attractor. The dashed part of the attractor is unstable—perturbations in this neighborhood tend to move away from the attractor. This graphical representation of the system makes it pretty easy to see how a small perturbation could dramatically change the system if the current combination of conditions and system state place the system on the attractor near the neighborhood where the attractor changes from stable to unstable. The figure illustrates one such scenario. The conditions/system state start at point F1. A small forcing perturbs the system off this point across the bifurcation. Further forcing now moves the system way off the current state to some new, far away, stable state. We go from a very high value of the system state to a very low value with only a very small change in conditions. Indeed, in this figure, the conditions remain constant from point F1 to the new value indicated by the white point—just a brief perturbation was sufficient to cause the drastic change.</p>
<p>At the fold, the derivative disappears (the derivative of a vertical line is undefined). This means that a perturbation that happens at a fold can lead to the system wandering well away from its local attractor.</p>
<p>Note that for most environmental conditions, there are three equilibria. Two of these are stable and one is unstable. One of the stable equilibria is in the good range of the system state. Specific examples might include high biomass or population size of a resource species, high forest cover, or clear water. One of the stable equilibria is in the bad range of the conditions such as low population density or biomass, deforested, or turbid water. The third equilibrium is intermediate, but it is unstable. When the system moves to that part of the attractor, perturbations will tend to move the system away to one of the stable parts of the attractor.</p>
</section>
</section>
<section id="hysteresis" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="hysteresis"><span class="header-section-number">6.3</span> Hysteresis</h2>
<p>Another notable feature of the fold-catastrophe model is known as <em>hysteresis</em> or path-dependency. Suppose that the system has been forced through point F2 to the fold and then a perturbation has driven it to the bad stable state of F1. Suppose also that, having witnessed the dramatic collapse of the system, people decided to do something to try to bring back the biological functionality. The problem is that shape of the attractor means that it will take an enormous investment to get the system back to its healthy state. In effect, the system needs to be forced back up the attractor toward the left-facing fold. Once there, it is possible to shock the system back up to the healthy (stable) leg of attractor, but in order to get it to this point, the system needs to nearly be brought back to its initial state.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/fold.png" class="img-fluid figure-img"></p>
<figcaption>Forced to the fold; drive to the bad state.</figcaption>
</figure>
</div>
<p>A <em>catastrophe</em> only happens when the attractor folds back on itself. A system can change by a large amount and not experience a catastrophe. This can happen because either there is a region of the attractor that has very high sensitivity or because the perturbation is just very large.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shape)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>logist <span class="ot">&lt;-</span> <span class="cf">function</span>(x,a,b) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(<span class="sc">-</span>(a<span class="sc">+</span>b<span class="sc">*</span>x)))</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,,<span class="dv">200</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="do">## need to make a&lt;0 so that whole curve appears</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># High Sensitivity</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="dv">1</span><span class="sc">-</span><span class="fu">logist</span>(<span class="at">x=</span>x,<span class="at">a=</span><span class="sc">-</span><span class="dv">10</span>,<span class="at">b=</span><span class="dv">1</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>,</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">frame=</span><span class="cn">TRUE</span>,</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Conditions"</span>, <span class="at">ylab=</span><span class="st">"State"</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="fu">Arrows</span>(<span class="dv">8</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">logist</span>(<span class="dv">8</span>,<span class="at">a=</span><span class="sc">-</span><span class="dv">10</span>,<span class="at">b=</span><span class="dv">1</span>),<span class="fl">11.8</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">logist</span>(<span class="dv">8</span>,<span class="at">a=</span><span class="sc">-</span><span class="dv">10</span>,<span class="at">b=</span><span class="dv">1</span>), <span class="at">arr.type =</span> <span class="st">"triangle"</span>, <span class="at">arr.length =</span> <span class="fl">0.2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a><span class="fu">Arrows</span>(<span class="dv">12</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">logist</span>(<span class="dv">8</span>,<span class="at">a=</span><span class="sc">-</span><span class="dv">10</span>,<span class="at">b=</span><span class="dv">1</span>),<span class="dv">12</span>,<span class="dv">1</span><span class="sc">-</span><span class="fu">logist</span>(<span class="fl">11.9</span>,<span class="at">a=</span><span class="sc">-</span><span class="dv">10</span>,<span class="at">b=</span><span class="dv">1</span>), <span class="at">arr.type =</span> <span class="st">"triangle"</span>, <span class="at">arr.length =</span> <span class="fl">0.2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Large Perturbation</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span>x), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">frame=</span><span class="cn">TRUE</span>,</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>,</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Conditions"</span>, <span class="at">ylab=</span><span class="st">"State"</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Arrows</span>(<span class="dv">5</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span><span class="dv">5</span>),<span class="fl">11.8</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span><span class="dv">5</span>), <span class="at">arr.type =</span> <span class="st">"triangle"</span>, <span class="at">arr.length =</span> <span class="fl">0.2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a><span class="fu">Arrows</span>(<span class="dv">12</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span><span class="dv">5</span>),<span class="dv">12</span>,<span class="fu">exp</span>(<span class="sc">-</span><span class="fl">0.07</span><span class="sc">*</span><span class="fl">11.7</span>), <span class="at">arr.type =</span> <span class="st">"triangle"</span>, <span class="at">arr.length =</span> <span class="fl">0.2</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="critical-slowing-down" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="critical-slowing-down"><span class="header-section-number">6.3.1</span> Critical Slowing Down</h3>
<p>An important part of this work is that there are signals of catastrophe. <span class="citation" data-cites="scheffer_etal2009">Scheffer et al. (<a href="references.html#ref-scheffer_etal2009" role="doc-biblioref">2009</a>)</span> argue that there are certain generic features of many systems as they move toward catastrophic change. The paper discusses epileptic seizures, asthma attacks, market collapses, abrupt shifts in oceanic circulation and climate, and ecological catastrophes such as sudden shifts in rangelands, or crashes of fish or wildlife populations. At first, it sounds like the vaguely mystical ideas about transcendent complexity, financial physics, etc. But really, there are a number of very sensible observations about dynamical systems and a convincing argument that these features will be commonly seen in real complex systems.</p>
<p>The basic idea is that there are a number of harbingers of catastrophic change in time series of certain complex systems. As one gets close to a catastrophic bifurcation, the very straightforward analysis that we used for evaluating the stability of the logistic model shows that the rate of return to the attractor decreases. As we move from the upper-left branch of the attractor toward point F2 in the figure, note that the slope of the tangent line at each point gets larger and larger. The slope on these tangent lines tells us about the behavior of the system following a small perturbation. As before, call the slope of these tangent lines <span class="math inline">\(\lambda\)</span>. Perturbations away from the attractor will grow or decay according to the equation <span class="math inline">\(n(t) = n(0) e^{\lambda t}\)</span>, where <span class="math inline">\(n(t)\)</span> is the size of the perturbation away from the attractor at time <span class="math inline">\(t\)</span>. If external forcing moves the state along the attractor to point <span class="math inline">\(B\)</span>, the slope is infinite (i.e., vertical) and the perturbation will grow rapidly away from the attractor in the direction of the perturbation.</p>
<p>As <span class="citation" data-cites="scheffer_etal2009">Scheffer et al. (<a href="references.html#ref-scheffer_etal2009" role="doc-biblioref">2009</a>)</span> note, one rarely has the luxury of measuring rates of return to equilibria in real systems but, fortunately, there are relatively easily measured consequences of this slow-down of rates of return to the attractor. They show in a lucid manner how the correlations between consecutive observations in a time series will increase as one approaches one of these catastrophic bifurcation points. This increased correlation has the effect of increasing the variance.</p>
<p>Two ways to diagnose an impending catastrophe in a system that is characterized by the fold bifurcation model are: (1) an increase in variance of the observations in the series and (2) an increase in the lag-1 autocorrelation. A third feature of impending catastrophes does not have quite as intuitive an explanation, but is also relatively straightforward. Dynamical systems approaching a catastrophic bifurcation will exhibit increased skewness to the fluctuations as well as flickering. The skewness means that the distribution of period-to-period fluctuations will become increasingly asymmetric. This has to do with the shape of the underlying attractor and how the values of the system are forced across it. Flickering means that the values will bounce back and forth between two different regimes (say, high and low) rapidly for a period before the catastrophe. This happens when the system is being forced with sufficient strength that it is bounced between two basins of attraction before getting sucked into a new one for good (or at least a long time).</p>
<p>In summary, there are four generic indicators of impending catastrophe in the fold catastrophe model:</p>
<ol type="1">
<li>Increased variance in the series</li>
<li>Increased autocorrelation</li>
<li>Increased skewness in the distribution of fluctuations</li>
<li>Flickering between two states</li>
</ol>
<p>These early-warning signs of impending catastrophe are collectively known as the <em>critical-slowing-down</em> hypothesis <span class="citation" data-cites="scheffer_etal2009">Scheffer et al. (<a href="references.html#ref-scheffer_etal2012" role="doc-biblioref">2012</a>)</span>.</p>
<p>In a system characterized by high resilience, a stochastic forcing will be followed by the rapid return to the attractor. As a result, there will be low correlation between subsequent states.</p>
<p>A nice way to visualize this is to imagine a ball rolling on a landscape. We can think of the equilibrium (or “attractor”) as being a valley on the landscape, which we will call the <em>basin of attraction</em>. Pushing the ball toward the basin of attraction will lead to it settling in to the attractor.</p>
<p>Once the ball has settled into this basin of attraction, it is difficult to push it out because the basin is deep and the sides are steep. The red arrows in the following sketch indicate the high-frequency oscillations of the ball in this deep attractor arising from the steep sides. The perturbed ball will rapidly settle back into its attractor following the perturbation.</p>
<p>When the system is low-resilience, it has a longer memory for perturbations and correlations increase. We can visualize this as a flattened-out basin of attraction. The longer red arrows in the sketch below indicate how the same perturbation will cause the ball to roll further – because the sides of the basin are less steep – as it settles back down. This leads to the greater variance and increased temporal autocorrelation predicted by the critical slowing down model of Scheffer et al. <span class="citation" data-cites="scheffer_etal2009">(<a href="references.html#ref-scheffer_etal2009" role="doc-biblioref">2009</a>)</span>.</p>
<p>There are all sorts of worrisome implications in these types of models for climate change, production systems, disease ecology, and the dynamics of endangered species. What I hope is that by really getting a handle on these generic systems, we will develop tools that will help us identify catastrophes soon enough that we might actually be able to do something about some of them. The real challenge, of course, is developing tools that give us the political will to tackle serious problems subject to structural uncertainty. I won’t hold my breath…</p>
<p>All the examples so far of the fold-catastrophe model use generic labels for the axes: “Conditions” and “System State”</p>
<p>What are the “shocks” that knock the system off its attractor? These are brief increases/decreases in either of the conditions or the system state that are exogenous to the system we’re studying. For example, the human population might decrease because there is an epidemic or a war. The temperature might temporarily be decreased because of a volcanic eruption. Forest cover might drop suddenly because there was an earthquake and people cut down more trees to cook and keep warm because they lost gas to their homes. These changes have nothing to do with the specific set of conditions/system state that we’re measuring so they are “exogenous” — they push the value of the system state off the attractor and the system either reverts back to where it was (if the perturbation was in a stable region) or it moves to a new part of the attractor if it was in an unstable region.</p>
<p>Why do we care? 1. possibility for abrupt changes 2. highlights importance of slow dynamics/forcing and relationship to fast dynamics 3. hysteresis should give us all pause</p>
<p>Precursors of Catastrophes <span class="citation" data-cites="scheffer_etal2009">(<a href="references.html#ref-scheffer_etal2009" role="doc-biblioref">Scheffer et al. 2009</a>)</span></p>
<p>A general phenomenon of a dynamical system approaching catastrophic change is known as Critical Slowing Down Some specific signs from time series: Increased Variance Increased Autocorrelation In addition, warning signs not necessarily related to slowing down Flickering Skewness</p>
<p>Low-resilience leads to high variance in the perturbed state and high temporal autocorrelation of state values.</p>
<p>Try to recreate the analysis of Scheffer and colleagues. The problem is they don’t fully specify the model and certainly don’t share code. This is close (though the non-resilient case is more variable than theirs).</p>
<p>The model they use is for a density-dependent population that experiences harvesting. Density dependence is logistic, while the harvesting rate is governed by a Holling Type III functional response:</p>
<p><span class="math display">\[
\frac{dX}{dt} = X(1 - \frac{X}{K}) - \frac{c X^2}{X^2 + 1}
\]</span> Where <span class="math inline">\(K\)</span> is the carrying capacity and <span class="math inline">\(c\)</span> is the maximum (asymptotic) harvest rate. This is essentially the model employed by both <span class="citation" data-cites="noy-meir1975">Noy-Meir (<a href="references.html#ref-noy-meir1975" role="doc-biblioref">1975</a>)</span> and <span class="citation" data-cites="may1977">May (<a href="references.html#ref-may1977" role="doc-biblioref">1977</a>)</span>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## logistic growth with harvesting</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>dX <span class="ot">&lt;-</span> <span class="cf">function</span>(X,K,c) X<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> X<span class="sc">/</span>K) <span class="sc">-</span> c<span class="sc">*</span>(X<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(X<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## high resilience</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>nmax <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,nmax)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="do">## mean-zero normal noise</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nmax) <span class="co"># normal innovations</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>X[<span class="dv">1</span>] <span class="ot">&lt;-</span> X0</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nmax){</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  X[i] <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">dX</span>(X[i<span class="dv">-1</span>],<span class="dv">15</span>,<span class="dv">1</span>) <span class="sc">+</span> epsilon[i]</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="co"># time series</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,X, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="fu">expression</span>(X[t]), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X[<span class="sc">-</span>nmax],X[<span class="sc">-</span><span class="dv">1</span>], <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(X[t]),  <span class="at">ylab=</span><span class="fu">expression</span>(X[t<span class="sc">+</span><span class="dv">1</span>]), <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">18</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">18</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-13-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X[<span class="sc">-</span>nmax],X[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1399281</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>ac <span class="ot">&lt;-</span> <span class="fu">acf</span>(X)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-13-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>ac[<span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Autocorrelations of series 'X', by lag

    1 
0.139 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## low resilience</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,nmax)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nmax) </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>X1[<span class="dv">1</span>] <span class="ot">&lt;-</span> X0</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nmax){</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  X1[i] <span class="ot">&lt;-</span> <span class="fu">pmax</span>(X1[i<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">dX</span>(X1[i<span class="dv">-1</span>],<span class="dv">15</span>,<span class="fl">2.6</span>) <span class="sc">+</span> epsilon[i],<span class="dv">0</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co"># time series</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>,X1, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="fu">expression</span>(X[t]), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-13-4.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X1[<span class="sc">-</span>nmax],X1[<span class="sc">-</span><span class="dv">1</span>], <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(X[t]),  <span class="at">ylab=</span><span class="fu">expression</span>(X[t<span class="sc">+</span><span class="dv">1</span>]),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">18</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">18</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-13-5.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X1[<span class="sc">-</span>nmax],X1[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4589379</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ac1 <span class="ot">&lt;-</span> <span class="fu">acf</span>(X1)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-13-6.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>ac1[<span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Autocorrelations of series 'X1', by lag

    1 
0.454 </code></pre>
</div>
</div>
<p>Both the variance and the covariance is greater less-resilient scenario with the high extraction rate. The high-frequency fluctuations are larger, making the variance large. This also makes it take longer for the deviations to to dissipate, so it’s more likely that two consecutive time steps will be above (or below) the average.</p>
<p>The overall lag-1 autocorrelation is significantly higher in this lower-resilience case. Moreover, the lag-2 autocovariance is also significantly greater than zero (indicated by being above the blue dashed line), indicating a much slower decay in the autocovariance.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(zoo)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">## logistic growth with harvesting</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>dX <span class="ot">&lt;-</span> <span class="cf">function</span>(X,K,c) X<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> X<span class="sc">/</span>K) <span class="sc">-</span> c<span class="sc">*</span>(X<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(X<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="dv">17</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>nmax <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>ccc <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">100</span>), <span class="fu">seq</span>(<span class="dv">1</span>,<span class="dv">4</span>,,<span class="dv">900</span>))</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,nmax)         </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>epsilon <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(nmax)</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>X2[<span class="dv">1</span>] <span class="ot">&lt;-</span> X0</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>nmax){</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  X2[i] <span class="ot">&lt;-</span> <span class="fu">pmax</span>(X2[i<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">dX</span>(X2[i<span class="dv">-1</span>],<span class="dv">15</span>,ccc[i]) <span class="sc">+</span> epsilon[i],<span class="dv">0</span>)</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(X2[i]<span class="sc">==</span><span class="dv">0</span>) <span class="cf">break</span> <span class="co"># no random resurrection</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a><span class="do">## index of the extinction</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>extinct <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">which</span>(X2<span class="sc">==</span><span class="dv">0</span>))</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>extinct,X2[<span class="dv">1</span><span class="sc">:</span>extinct], <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="fu">expression</span>(X[t]), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(X2[<span class="sc">-</span>nmax],X2[<span class="sc">-</span><span class="dv">1</span>])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9413534</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>ac2 <span class="ot">&lt;-</span> <span class="fu">acf</span>(X2[<span class="dv">1</span><span class="sc">:</span>extinct])</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sdd <span class="ot">&lt;-</span> <span class="fu">rollapplyr</span>(X2[<span class="dv">1</span><span class="sc">:</span>extinct], <span class="dv">100</span>, sd)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sdd, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="st">"Standard Deviation"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-14-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now look at how the correlations change over time.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(zoo)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## a little function to calculate a rolling autocorrelation</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>getacf <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">acf</span>(x,<span class="at">lag.max=</span><span class="dv">1</span>,<span class="at">plot=</span><span class="cn">FALSE</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tmp<span class="sc">$</span>acf[<span class="dv">2</span>])</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>aaa <span class="ot">&lt;-</span> <span class="fu">rollapplyr</span>(X2[<span class="dv">1</span><span class="sc">:</span>extinct], <span class="dv">100</span>, getacf)</span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(aaa, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"Time"</span>, <span class="at">ylab=</span><span class="st">"Autocorrelation"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>x2early <span class="ot">&lt;-</span> X2[<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>x2late <span class="ot">&lt;-</span> X2[(extinct<span class="dv">-200</span>)<span class="sc">:</span>extinct]</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2early[<span class="sc">-</span><span class="dv">200</span>],x2early[<span class="sc">-</span><span class="dv">1</span>], <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(X[t]),  <span class="at">ylab=</span><span class="fu">expression</span>(X[t<span class="sc">+</span><span class="dv">1</span>]),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-15-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x2late[<span class="sc">-</span><span class="dv">200</span>],x2late[<span class="sc">-</span><span class="dv">1</span>], <span class="at">pch=</span><span class="dv">16</span>, </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="fu">expression</span>(X[t]),  <span class="at">ylab=</span><span class="fu">expression</span>(X[t<span class="sc">+</span><span class="dv">1</span>]),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">18</span>))</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">a=</span><span class="dv">0</span>,<span class="at">b=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-15-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(<span class="fu">cor</span>(x2early[<span class="sc">-</span><span class="dv">200</span>],x2early[<span class="sc">-</span><span class="dv">1</span>]),<span class="fu">cor</span>(x2late[<span class="sc">-</span><span class="dv">200</span>],x2late[<span class="sc">-</span><span class="dv">1</span>]))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1740171 0.8205540</code></pre>
</div>
</div>
<p>What happens when a the system is forced onto the unstable part of the attractor? Until it’s pushed over the boundary, it will tend to return the stable arm. If this happens repeatedly, you will see flickering</p>
<p>If one side of the basin is stretched out, making it shallower, the distribution of oscillations will be skewed.</p>
<p>Increased skewness of perturbations <span class="citation" data-cites="guttal_jayaprakash2008">(<a href="references.html#ref-guttal_jayaprakash2008" role="doc-biblioref">Guttal and Jayaprakash 2008</a>)</span>.</p>
</section>
</section>
<section id="stability-analysis-of-the-lotka-volterra-model" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="stability-analysis-of-the-lotka-volterra-model"><span class="header-section-number">6.4</span> Stability Analysis of the Lotka-Volterra Model</h2>
<p>As we saw in <a href="#sec-lv" class="quarto-xref"><span>Section 6.0.1</span></a>, the classic predator-prey model of Lotka and Volterra shows cyclical dynamics. What happens if we perturb the model off of its simplex? Will the system return to the simplex and continue cycling in the same manner as before the perturbation? Will the system diverge, perhaps leading to the extinction of one or both species? We can use stability analysis to investigate these questions. In a nutshell, we use the structural information contained in the equations to investigate whether or not a small perturbation off of the simplex (i.e., the phase portrait) will increase or decay back to the simplex.</p>
<p>First solve the predation equations to find their equilibrium values. Solving the first, we see that there is an equlibrium (i.e., <span class="math inline">\(\dot{x}_1=0\)</span>) at <span class="math inline">\(x_1=0\)</span> or, less trivially, <span class="math inline">\(x_1=b_1/a_{12}\)</span>. Solving the second, we similarly find <span class="math inline">\(x_2=0\)</span> and <span class="math inline">\(x_2=b_2/a_{21}\)</span>. There are thus two equilibria for this model: <span class="math inline">\((0,0)\)</span> and <span class="math inline">\((b_1/a_{12}, b_2/a_{21})\)</span>.</p>
<p>It doesn’t take too much thought to see that the first of these equilibria is unstable. Since the first term in the model contains an exponential growth term (corresponding to the first assumption), any perturbation away from the zero equilibrium will grow.</p>
<p>The Lotka-Volterra equations are nonlinear – the rate of prey removal and the rate of growth of predators depends on the interaction of the two state variables, <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span>. To determine the stability of the non-trivial equilibrium, we need to linearize the system around the equilibrium point. That is, we perform a Taylor series expansion of the system around the equilibrium, discarding all higher-order terms (i.e., square and above). For the multivariate system, we use the Jacobian matrix of the system</p>
<p><span class="math display">\[
\mathbf{J} =
\begin{pmatrix}
      \partial F/\partial x_1 &amp; \partial F/\partial x_2 \\
      \partial G/\partial x_1 &amp; \partial G/\partial x_2
\end{pmatrix},
\]</span></p>
<p>where <span class="math inline">\(F\)</span> is the equation for herbivores and <span class="math inline">\(G\)</span> is the equation for predators, which is equal to:</p>
<p><span class="math display">\[
\mathbf{J} =
\begin{pmatrix}
      b_1 - a_{12} x_2 &amp; - a_{12} x_1 \\
      a_{21} x_2 &amp; -b_2 + a_{12} x_1
\end{pmatrix}
=
\begin{pmatrix}
      0 &amp; \frac{-b_2 a_{12}}{a_{21}}\\
      \frac{b_1 a_{21}}{a_{12}}  &amp; 0
\end{pmatrix}
\]</span></p>
<p>The latter matrix comes from substituting the equilibrium values for <span class="math inline">\(x_1\)</span> and <span class="math inline">\(x_2\)</span> and simplifying.</p>
<p>The stability criterion where a perturbation decays back to the equilibrium translates into all the eigenvalues of <span class="math inline">\(\mathbf{J}\)</span> having negative real parts. We can calucate the eigenvalues of <span class="math inline">\(\mathbf{J}\)</span> by solving the characteristic equation <span class="math inline">\(\det(\mathbf{J} - \lambda \mathbf{I})=0\)</span>:</p>
<p><span class="math display">\[
\det
\begin{bmatrix}
      \lambda &amp; \frac{-b_2 a_{12}}{a_{21}}  \\
      \frac{b_1 a_{21}}{a_{12}}  &amp; -\lambda
\end{bmatrix}
= \lambda^2 + b_1 b_2 = 0.
\]</span></p>
<p>The solution to the characteristic equation is thus <span class="math inline">\(\lambda = \pm i\sqrt{b_1b_2}\)</span>. This solution contains no real parts – i.e., the real parts are zero – only imaginary. This means that the equilibrium is neither stable nor unstable but that the model is purely oscillatory.</p>
</section>
<section id="stability-and-complexity" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="stability-and-complexity"><span class="header-section-number">6.5</span> Stability and Complexity</h2>
<p>In model ecosystems, the more species the model contains, the less asymptotically stable it is (this results from the requirement that the real parts of all eigenvalues of the Jacobian matrix be negative for stability)</p>
<p>One of the central debates in ecology surrounds the problem of stability and complexity. Biological intuition suggests that more complex ecosystems are more stable. More species should lead to greater functional redundancy, e.g., leading to greater resilience. Simple experiments support this intuition <strong>refs</strong>. Elton: “simple communities were more easily upset than that of richer ones; that is, more subject to destructive oscillations in populations, and more vulnerable to invasions”</p>
<p>In his foundational (1973) monograph, Robert May noted that the mathematical theory of community ecology did something very odd. <span class="citation" data-cites="may1973">May (<a href="references.html#ref-may1973" role="doc-biblioref">1973</a>)</span> shows that the standard, off-the-shelf mathematics of stability analysis say that increased food web complexity actually leads to lower stability! This prediction was odd because it violated the intuitions of most field ecologists, who felt that more complex communities were more stable. Surely, with more species in a given community, there should be greater functional redundancy which, in turn, should make complex communities robust to perturbations—really the definition of stability.</p>
<p>How did this work? First, linearize the model around the equilibrium vector:</p>
<p><span class="math display">\[ \dot{\mathbf{u}} = \mathbf{A} \mathbf{u}, \]</span></p>
<p>where <span class="math inline">\(\mathbf{u}\)</span> is a vector of length <span class="math inline">\(k\)</span> of deviations of the populations from their equilibria, i.e., <span class="math inline">\(u_i = x_i - x^*_i\)</span>, where <span class="math inline">\(x^*_i\)</span> is the equilibrium value for species <span class="math inline">\(i\)</span>.</p>
<p>For the equilibrium to be stable, <strong>all the eigenvalues of matrix</strong> <span class="math inline">\(\mathbf{A}\)</span> msut have negative real parts. If all of the eigenvalues of <span class="math inline">\(\mathbf{A}\)</span> have negative real parts, it means that all the perturbations away from the equilibrium, <span class="math inline">\(\mathbf{u}\)</span>, will decay exponentially back toward the equilibrium. Were any of the eigenvalues non-negative, perturbations would grow and the equilibrium would be, by definition, unstable.</p>
<p><span class="citation" data-cites="may1973">May (<a href="references.html#ref-may1973" role="doc-biblioref">1973</a>)</span> showed that as <span class="math inline">\(k\)</span> gets larger (i.e., the number of species in a community increases), the likelihood that all the eigenvalues of <span class="math inline">\(\mathbf{A}\)</span> will be negative decreases.</p>
<p>How do we reconcile this mathematical fact with the very strong intuition that more complex ecological systems are more stable? Some clues:</p>
<p><span class="citation" data-cites="may1973">May (<a href="references.html#ref-may1973" role="doc-biblioref">1973</a>)</span> used random values for the interaction strengths for the community matrix. <span class="citation" data-cites="yodzis1981">Yodzis (<a href="references.html#ref-yodzis1981" role="doc-biblioref">1981</a>)</span> found that food webs constructed from real interaction data were more stable than randomly-assembled food webs. Moreover, he found that interaction strengths were often weaker than the random-interaction models, such as those used by <span class="citation" data-cites="may1973">May (<a href="references.html#ref-may1973" role="doc-biblioref">1973</a>)</span>. <span class="citation" data-cites="pimm_lawton1978">Pimm and Lawton (<a href="references.html#ref-pimm_lawton1978" role="doc-biblioref">1978</a>)</span> found that empirical food webs with omnivores were more stable than those without. Omnivores, by spreading their consumption out over a large range of prey types, generally have <em>weak</em> ecological interactions with other species. <span class="citation" data-cites="mccann_etal1998">McCann, Hastings, and Huxel (<a href="references.html#ref-mccann_etal1998" role="doc-biblioref">1998</a>)</span> showed formally that the key to stability was many weak connections in food webs.</p>
<p>Lotka-Volterra cycles because of the over-shooting of a tightly-coupled system. Omnivores are generalists, which means they have low interaction strengths with their different prey. We can summarize the feature of food webs that promote stability. These include:</p>
<ol type="1">
<li>Many connections</li>
<li>Low average interaction strength</li>
<li>Prey switching/omnivory</li>
<li>Negative covariance between abundances</li>
</ol>
<p>Negative covariance stabilizes abundance. The variance of productivity of two species (a and b) follows from the definition of variance</p>
<p><span class="math display">\[
s_{(a+b)}^2=s_a^2+s_b^2+2 \operatorname{cov}(a, b)
\]</span></p>
<p>It is the sum of the individual variances plus twice the covariance between them. If <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> are positively correlated the variance of their sum will exceed the sum of their individual variances. Not exactly the behavior you want in a portfolio!</p>
<p>Hunter-gatherers are generalists, omnivores who engage in extensive prey-switching. <span class="citation" data-cites="dunne_etal2016">Dunne et al. (<a href="references.html#ref-dunne_etal2016" role="doc-biblioref">2016</a>)</span> show that human foragers are what they call “super-generalist and highly-omnivorous consumers” who actually have substantial stabilizing effects on marine and coastal food webs in the Aleutian Islands. <span class="citation" data-cites="crabtree_etal2019">Crabtree, Bird, and Bird (<a href="references.html#ref-crabtree_etal2019" role="doc-biblioref">2019</a>)</span> suggest that Martu hunter-gatherers were “knitters” of food webs in the Western Desert of Australia and that food webs lost substantial complexity when the Martu were forced off their land and foraging way of life.</p>
<p>Food items are ranked in quality (lower is better). E/h is the net energy that an item yields. E/t is energy gained per unit of search time. The optimal diet includes all items in the diet more highly ranked than where these lines intersect <span class="citation" data-cites="macarthur_pianka1966">(<a href="references.html#ref-macarthur_pianka1966" role="doc-biblioref">MacArthur and Pianka 1966</a>)</span>.</p>
<p>Fallback Foods: Increased diet breadth. In a bad year, you search longer so the net energy per time spent searching is lower. This moves the equilibrium out and you add more items to the diet.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Fallback Foods</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="at">length=</span><span class="dv">500</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x,b) {</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>b<span class="sc">*</span>(x<span class="dv">-1</span>))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> <span class="cf">function</span>(x,a) a<span class="sc">/</span>x</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="fu">f</span>(x,<span class="at">b=</span><span class="fl">0.1</span>), <span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">axes=</span><span class="cn">FALSE</span>,</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Item Rank"</span>,</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab=</span><span class="st">"Energy Gain"</span>,</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f</span>(x,<span class="at">b=</span><span class="fl">0.05</span>), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x,<span class="fu">f1</span>(x,<span class="at">a=</span><span class="dv">2</span>), <span class="at">lwd=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"grey"</span>)</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co"># found approximate points using locator()</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">2.9</span>,<span class="fl">0.9648077</span>,<span class="fu">expression</span>(E<span class="sc">/</span>h))</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">18.75</span>,<span class="fl">0.8848253</span>,<span class="fu">expression</span>(E<span class="sc">^</span>g<span class="sc">/</span>T))</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">18.75</span>,<span class="fl">0.6362313</span>,<span class="fu">expression</span>(E<span class="sc">^</span>b<span class="sc">/</span>T))</span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">5.5</span>,<span class="dv">0</span>,<span class="fl">7.4</span>,<span class="dv">0</span>, <span class="at">lwd=</span><span class="dv">10</span>, <span class="at">col=</span><span class="st">"green"</span>, <span class="at">lend=</span><span class="dv">2</span>) </span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fl">6.45</span>,<span class="fl">0.04825</span>, <span class="st">"Fallback Foods"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="stability-vulnerability-resilience" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="stability-vulnerability-resilience"><span class="header-section-number">6.6</span> Stability, Vulnerability, Resilience</h2>
<p>Vulnerability the susceptibility of a system to disturbances from perturbations, sensitivity to perturbations, and the capacity to adapt Adaptation (small-a) reduction vulnerability Resiliency “the capacity of a system to absorb disturbance and reorganize while undergoing change so as to still retain essentially the same function, structure, identity, and feedbacks” (Walker et al.&nbsp;2007) cf.&nbsp;‘time to return to equilibrium following perturbation’</p>
<p>An obvious example of panarchy — specifically cross-scale interactions — is a federal system of government. There are interactions between cities/counties/municipalities at the lowest level, states at the intermediate level, and the federal government at the top level.</p>
<p>The economic/social resilience of Rust-Belt city is likely to be affected by federal assistance programs, which are typically brokered by the states. For example, a state that refuses Medicare expansion affects the resilience of a small county hospital in a poor area where many people are uninsured.</p>
<p>The Adaptive cycle is similar to the model for the collapse of complex societies proposed by <span class="citation" data-cites="tainter1988">Tainter (<a href="references.html#ref-tainter1988" role="doc-biblioref">1988</a>)</span>. Societies gain complexity as they solve problems. There comes a point where the diminishing marginal returns to added complexity get so great that added complexity comes at a cost (note that after the peak, it’s no longer simply diminishing marginal returns, but diminishing returns period). This is quite similar to the idea of crystallization in the adaptive cycle. We can model this using the function described in <span class="citation" data-cites="leslie_winterhalder2002">Leslie and Winterhalder (<a href="references.html#ref-leslie_winterhalder2002" role="doc-biblioref">2002</a>)</span>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Leslie &amp; Winterhalder (2002) right-ibis function</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">18</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">16</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>ribis <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m,n,r){</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">|</span> x<span class="sc">&gt;=</span>r){</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    ibis <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&gt;=</span><span class="dv">0</span> <span class="sc">&amp;</span> x<span class="sc">&lt;</span>m) {</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>    ibis <span class="ot">&lt;-</span> <span class="fu">exp</span>(m<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((m<span class="sc">-</span>n)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">-</span> (m<span class="sc">*</span>x<span class="sc">/</span>(m<span class="sc">-</span>n)<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span> x<span class="sc">^</span>(m<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>((m<span class="sc">-</span>n)<span class="sc">^</span><span class="dv">2</span>)) <span class="sc">*</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>      m<span class="sc">^</span>(<span class="sc">-</span>m<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(m<span class="sc">-</span>n)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(x<span class="sc">&gt;=</span>m <span class="sc">&amp;</span> x<span class="sc">&lt;</span>r){</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>    ibis <span class="ot">&lt;-</span>  <span class="dv">1</span><span class="sc">-</span>(x<span class="sc">-</span>m)<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(m<span class="sc">-</span>r)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(ibis)</span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">16</span>,<span class="at">length=</span><span class="dv">100</span>)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>aaa <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">100</span>)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) aaa[i] <span class="ot">&lt;-</span> <span class="fu">ribis</span>(<span class="at">x=</span>y[i],<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">r=</span>r)</span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">ribis</span>(<span class="at">x=</span><span class="dv">8</span>,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">r=</span>r)</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>db <span class="ot">&lt;-</span> <span class="fu">ribis</span>(<span class="at">x=</span><span class="dv">15</span>,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">r=</span>r)</span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>cl <span class="ot">&lt;-</span> <span class="fu">ribis</span>(<span class="at">x=</span><span class="fl">2.895</span>,<span class="at">m=</span>m,<span class="at">n=</span>n,<span class="at">r=</span>r)</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y,aaa,<span class="at">type=</span><span class="st">"l"</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">axes=</span><span class="cn">FALSE</span>, <span class="at">frame=</span><span class="cn">TRUE</span>,</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxs=</span><span class="st">"i"</span>, <span class="at">yaxs=</span><span class="st">"i"</span>,</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">1.1</span>),</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Complexity"</span>, <span class="at">ylab=</span><span class="st">"Benefits to Complexity"</span>)</span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">8</span>,mc,<span class="dv">0</span>,mc,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">8</span>,<span class="dv">0</span>,<span class="dv">8</span>,mc,<span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">15</span>,db,<span class="dv">0</span>,db,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="dv">15</span>,<span class="dv">0</span>,<span class="dv">15</span>,db,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="co">#segments(2.895,cl,0,cl,lty=3, col="red")</span></span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="fl">2.895</span>,<span class="dv">0</span>,<span class="fl">2.895</span>,cl,<span class="at">lty=</span><span class="dv">3</span>, <span class="at">col=</span><span class="st">"red"</span>)</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="co">#mtext(expression(paste(B, "*")),2, at=mc, adj=1, las=2)</span></span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(B[max]),<span class="dv">2</span>, <span class="at">at=</span>mc, <span class="at">adj=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(B[mid]),<span class="dv">2</span>, <span class="at">at=</span>db, <span class="at">adj=</span><span class="dv">1</span>, <span class="at">las=</span><span class="dv">2</span>)</span>
<span id="cb39-43"><a href="#cb39-43" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(C[lo]),<span class="dv">1</span>, <span class="at">at=</span><span class="fl">2.895</span>, <span class="at">padj=</span><span class="dv">1</span>)</span>
<span id="cb39-44"><a href="#cb39-44" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(C[opt]),<span class="dv">1</span>, <span class="at">at=</span><span class="dv">8</span>, <span class="at">padj=</span><span class="dv">1</span>)</span>
<span id="cb39-45"><a href="#cb39-45" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="fu">expression</span>(C[hi]),<span class="dv">1</span>, <span class="at">at=</span><span class="dv">15</span>, <span class="at">padj=</span><span class="dv">1</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="complex_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-crabtree_etal2019" class="csl-entry" role="listitem">
Crabtree, Stefani A., Douglas W. Bird, and Rebecca Bliege Bird. 2019. <span>“Subsistence Transitions and the Simplification of Ecological Networks in the <span class="nocase">Western Desert of Australia</span>.”</span> <em>Human Ecology</em> 47 (2): 165–77. <a href="https://doi.org/10.1007/s10745-019-0053-z">https://doi.org/10.1007/s10745-019-0053-z</a>.
</div>
<div id="ref-demenocal_etal2000" class="csl-entry" role="listitem">
deMenocal, Peter, Joseph Ortiz, Tom Guilderson, Jess Adkins, Michael Sarnthein, Linda Baker, and Martha Yarusinsky. 2000. <span>“Abrupt Onset and Termination of the <span>African Humid Period</span>: Rapid Climate Responses to Gradual Insolation Forcing.”</span> <em>Quaternary Science Reviews</em> 19 (1): 347–61. <a href="https://doi.org/10.1016/S0277-3791(99)00081-5">https://doi.org/10.1016/S0277-3791(99)00081-5</a>.
</div>
<div id="ref-dunne_etal2016" class="csl-entry" role="listitem">
Dunne, Jennifer A., Herbert Maschner, Matthew W. Betts, Nancy Huntly, Roly Russell, Richard J. Williams, and Spencer A. Wood. 2016. <span>“The Roles and Impacts of Human Hunter-Gatherers in <span>North Pacific</span> Marine Food Webs.”</span> <em>Scientific Reports</em> 6 (1): 21179. <a href="https://doi.org/10.1038/srep21179">https://doi.org/10.1038/srep21179</a>.
</div>
<div id="ref-guttal_jayaprakash2008" class="csl-entry" role="listitem">
Guttal, Vishwesha, and Ciriyam Jayaprakash. 2008. <span>“Changing Skewness: An Early Warning Signal of Regime Shifts in Ecosystems.”</span> <em>Ecology Letters</em> 11 (5): 450–60. <a href="https://doi.org/10.1111/j.1461-0248.2008.01160.x">https://doi.org/10.1111/j.1461-0248.2008.01160.x</a>.
</div>
<div id="ref-hastings_powell1991" class="csl-entry" role="listitem">
Hastings, Alan, and Thomas Powell. 1991. <span>“Chaos in a Three-Species Food Chain.”</span> <em>Ecology</em> 72 (3): 896–903. <a href="https://doi.org/10.2307/1940591">https://doi.org/10.2307/1940591</a>.
</div>
<div id="ref-leslie_winterhalder2002" class="csl-entry" role="listitem">
Leslie, P., and B. Winterhalder. 2002. <span>“Demographic Consequences of Unpredictability in Fertility Outcomes.”</span> <em>American Journal of Human Biology</em> 14 (2): 168–83. <a href="https://doi.org/10.1002/ajhb.10044">https://doi.org/10.1002/ajhb.10044</a>.
</div>
<div id="ref-macarthur_pianka1966" class="csl-entry" role="listitem">
MacArthur, Robert H., and Eric R. Pianka. 1966. <span>“On Optimal Use of a Patchy Environment.”</span> <em>The American Naturalist</em> 100 (916): 603–9. <a href="http://www.jstor.org/stable/2459298">http://www.jstor.org/stable/2459298</a>.
</div>
<div id="ref-may1973" class="csl-entry" role="listitem">
May, R. M. 1973. <em>Stability and Complexity in Model Ecosystems</em>. Princeton: Princeton University Press.
</div>
<div id="ref-may1976" class="csl-entry" role="listitem">
———. 1976. <span>“Simple Mathematical-Models with Very Complicated Dynamics.”</span> <em>Nature</em> 261 (5560): 459–67. <a href="https://doi.org/10.1038/261459a0">https://doi.org/10.1038/261459a0</a>.
</div>
<div id="ref-may1977" class="csl-entry" role="listitem">
———. 1977. <span>“Thresholds and Breakpoints in Ecosystems with a Multiplicity of Stable States.”</span> <em>Nature</em> 269 (5628): 471–77. <a href="https://doi.org/10.1038/269471a0">https://doi.org/10.1038/269471a0</a>.
</div>
<div id="ref-mccann_etal1998" class="csl-entry" role="listitem">
McCann, K., A. Hastings, and G. R. Huxel. 1998. <span>“Weak Trophic Interactions and the Balance of Nature.”</span> <em>Nature</em> 395: 794–98. <a href="https://doi.org/10.1038/27427">https://doi.org/10.1038/27427</a>.
</div>
<div id="ref-noy-meir1975" class="csl-entry" role="listitem">
Noy-Meir, Imanuel. 1975. <span>“Stability of Grazing Systems: An Application of Predator-Prey Graphs.”</span> <em>Journal of Ecology</em> 63 (2): 459–81. <a href="https://doi.org/10.2307/2258730">https://doi.org/10.2307/2258730</a>.
</div>
<div id="ref-pimm_lawton1978" class="csl-entry" role="listitem">
Pimm, S. L., and J. H. Lawton. 1978. <span>“On Feeding on More Than One Trophic Level.”</span> <em>Nature</em> 275: 542–44. <a href="https://doi.org/10.1038/275542a0">https://doi.org/10.1038/275542a0</a>.
</div>
<div id="ref-scheffer_etal2009" class="csl-entry" role="listitem">
Scheffer, M., J. Bascompte, W. A. Brock, V. Brovkin, S. R. Carpenter, V. Dakos, H. Held, E. H. van Nes, M. Rietkerk, and G. Sugihara. 2009. <span>“Early-Warning Signals for Critical Transitions.”</span> <em>Nature</em> 461 (7260): 53–59. <a href="https://doi.org/10.1038/nature08227">https://doi.org/10.1038/nature08227</a>.
</div>
<div id="ref-scheffer_carpenter2003" class="csl-entry" role="listitem">
Scheffer, M., and S. R. Carpenter. 2003. <span>“Catastrophic Regime Shifts in Ecosystems: Linking Theory to Observation.”</span> <em>Trends in Ecology &amp; Evolution</em> 18 (12): 648–56. <a href="https://doi.org/10.1016/j.tree.2003.09.002">https://doi.org/10.1016/j.tree.2003.09.002</a>.
</div>
<div id="ref-scheffer_etal2012" class="csl-entry" role="listitem">
Scheffer, M., S. R. Carpenter, Timothy M. Lenton, J. Bascompte, W. Brock, V. Dakos, J. van de Koppel, et al. 2012. <span>“Anticipating Critical Transitions.”</span> <em>Science</em> 338 (6105): 344–48. <a href="https://doi.org/10.1126/science.1225244">https://doi.org/10.1126/science.1225244</a>.
</div>
<div id="ref-tainter1988" class="csl-entry" role="listitem">
Tainter, Joseph A. 1988. <em>The Collapse of Complex Societies</em>. Cambridge: Cambridge University Press. <a href="https://books.google.com/books?id=YdW5wSPJXIoC">https://books.google.com/books?id=YdW5wSPJXIoC</a>.
</div>
<div id="ref-yodzis1981" class="csl-entry" role="listitem">
Yodzis, P. 1981. <span>“The Stability of Real Ecosystems.”</span> <em>Nature</em> 289 (5799): 674–76. <a href="https://doi.org/10.1038/289674a0">https://doi.org/10.1038/289674a0</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./decision.html" class="pagination-link" aria-label="Risk, Uncertainty, and Decision-Making">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Risk, Uncertainty, and Decision-Making</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./commons.html" class="pagination-link" aria-label="Emergence and Governing the Commons">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Emergence and Governing the Commons</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>